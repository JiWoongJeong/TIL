[TOC]



## 2과목. SQL 기본 및 활용

### 제1장. SQL 기본

#### 제1절 관계형 DB 개요

- SQL
  - 데이터 조작어 (DML : Data Manipulation Language) : 사용자가 응용 프로그램, 질의어 -> 저장된 DB에 실질적으로 접근 시 사용
    - SELECT : 데이터 조회, 검색 -> RETRIEVE
    - INSERT, UPDATE, DELETE
  - 데이터 정의어 (DDL : Data Definition Language) : 데이터 구조 정의 (스키마, 도메인, 테이블, 뷰, 인덱스)
    - CREATE, ALTER, DROP, RENAME : 생성, 변경, 삭제, 이름 변경
  - 데이터 제어어 (DCL : Data Control Language) : DB 접근, 객체 사용
    - GRANT, REVOKE : 권한 주고 회수
  - 트랜잭션 제어어 (TCL : Transaction Control Language) : 논리적 작업 단위 묶어서 DML에 의해 조작된 결과 작업단위 (트랜잭션) 별로 제어
    - COMMIT, ROLLBACK

#### 제2절 DDL

- CREATE

  ```sql
  CREATE TABLE 테이블이름 ( 칼럼명1 DATATYPE (DEFAULT 형식), 칼럼명2 DATATYPE (DEFAULT 형식),)
  ```

  - ![image-20211102210446603](C:\Users\j2woo\AppData\Roaming\Typora\typora-user-images\image-20211102210446603.png)

    ```sql
    CREATE TABLE PRODUCT
    ( PROD_ID VARCHAR2(10) NOT NULL,
     PROD_NM VARCHAR2(100) NOT NULL,
     REG_DT DATE NOT NULL,
     REGR_NO NUMBER(10),
     CONSTRAINT PRODUCT_PK PRIMARY KEY (PROD_ID) );
    ```

  - NULL

    - 모르는 값, 값의 부재
    - 모든 비교 -> 알 수 없음 반환 (Unknown) : IS NULL 제외

  - 문제

    ![image-20211105215810922](C:\Users\j2woo\AppData\Roaming\Typora\typora-user-images\image-20211105215810922.png)

    ![image-20211105215830450](C:\Users\j2woo\AppData\Roaming\Typora\typora-user-images\image-20211105215830450.png)

    - `DELETR FROM T` 후 R 남아있는 데이터 : (1, NULL), (2, NULL)

  - 제약조건 (Constraint)

    - PRIMARY KEY (기본 키) : 테이블당 1개만 생성 가능, UNIQUE + NOT NULL
    - UNIQUE KEY (고유키) : 중복 값 X, NULL 입력 O
    - NOT NULL
    - CHECK : 무결성 유지 -> 특정 Column에 설정
    - FOREIGN KEY (외래키) : 테이블당 여러 개 생성 가능

  - 테이블명 : 반드시 문자로 시작, A~Z, a~z, 0~9, _, $, #만 허용

  - 문제

    ```sql
    EMP /* 부서 정의 X -> 기본부서 (코드 0000) 배치, 입사일자 (JOIN_DATE)에 index 생성 */
     
    EMP_NO:VARCHAR2(10) NOT NULL (PK)
    EMP(NM):VARCHAR2(30) NOT NULL
    DEPT_CODE:VARCHAR2(4)NOT NULL
    JOIN_DATE:DATE NOT NULL
    REGIST_DATE:DATE NULL
    ```

    ```sql
    CREATE TABLE EMP(
    EMP_NO VARCHAR2(10) PRIMARY KEY,
    EMP_NM VARCHAR2(30) NOT NULL,
    DEPT_CODE VARCHAR2(4) DEFAULT '0000' NOT NULL,
    JOIN_DATE DATE NOT NULL
    REGIST_DATE DATE NULL);
     
    CREATE INDEX IDX_EMP_01 ON EMP(JOIN_DATE);
    ```

    ```sql
    CREATE TABLE EMP(
    EMP_NO VARCHAR2(10) NOT NULL,
    EMP_NM VARCHAR2(30) NOT NULL,
    DEPT_CODE VARCHAR2(4) DEFAULT '0000' NOT NULL,
    JOIN_DATE DATE NOT NULL,
    REGIST_DATE DATE);
    
    ALTER TABLE EMP ADD CONSTRAINT EMP_PK PRIMARY KEY (EMP_NO);
    
    CREATE INDEX IDX_EMP_01 ON EMP (JOIN DATE);
    ```

  - 문제

    ```sql
    CREATE TABLE 학생 (학번 CHAR (8) PRIMARY KEY, 장학금 INTEGER);
    
    /* SQL1 */ SELECT COUNT(*) FROM 학생
    /* SQL2 */ SELECT COUNT(학번) FROM 학생
    ```

    - SQL1 = SQL2 결과

  - 외래키

    - 테이블 생성 시 설정, NULL O, 한 테이블에 여러 개 존재, 참조 무결성 제약

  - 문제 : A, B, C 차례로 실행 -> A, C 수행결과

    ```sql
    CREATE TABLE 부서 (부서번호 CHAR(10), 부서명 CHAR(10), PRIMARY KEY(부서번호));
    
    CREATE TABLE 직원 (직원번호 CHAR(10), 소속부서 CHAR(10), PRIMARY KEY(직원번호), FOREIGN KEY(소속부서) REFERENCES 부서(부서번호) ON DELETE CASCADE);
    
    INSERT INTO 부서 VALUES('10', '영업과');
    INSERT INTO 부서 VALUES('20', '기획과');
    
    INSERT INTO 직원 VALUES('1000', '10');
    INSERT INTO 직원 VALUES('2000', '20');
    INSERT INTO 직원 VALUES('3000', '20');
    
    /* A */ SELECT COUNT(직원번호) FROM 직원; /* 3 */
    /* B */ DELETE FROM 부서 WHERE 부서번호 = '20';
    /* C */ SELECT COUNT(직원번호) FROM 직원; /* 1 */
    ```

- ALTER

  - ADD COLUMN

    ```sql
    ALTER TABLE 테이블명 ADD 추가할 칼럼명 데이터유형;
    ```

  - DROP COLUMN

    ```sql
    ALTER TABLE 테이블명 DROP 삭제할 칼럼명;
    ```

  - MODIFY COLUMN

    - Oracle

      ```sql
      ALTER TABLE 테이블명 MODIFY (칼럼명1 데이터유형 (DEFAULT 식) (NOT NULL), 칼럼명2 데이터유형 (DEFAULT 식) (NOT NULL),)
      ```

    - SQL Server

      ```sql
      ALTER TABLE 테이블명 ALTER (칼럼명1 데이터유형 (DEFAULT 식) (NOT NULL), 칼럼명2 데이터유형 (DEFAULT 식) (NOT NULL),)
      ```

    - Rename

      ```sql
      ALTER TABLE 테이블명 RENAME COLUMN 변경해야 할 칼럼명 TO 새로운 칼럼명;
      ```

  - DROP CONSTRAINT

    ```sql
    ALTER TABLE 테이블명 DROP CONSTRAINT 제약조건명;
    ```

  - ADD CONSTRAINT

    ```sql
    ALTER TABLE 테이블명 ADD CONSTRAINT 제약조건명 제약조건 (칼럼명);
    ```

    - Delete / Modify
      - Cascade : Master 삭제 시 Child 같이 삭제
      - Set Null : Master 삭제 시 Child 해당 필드 Null
      - Set Default : Master 삭제 시 Child 해당 필드 Default 값으로
      - Restrict : Child 테이블에 PK 없으면 Master 삭제 O
      - No Action : 참조무결성 X 삭제/수정 액션 X
    - Insert
      - Automatic : Master 테이블에 PK 없으면 Master PK 생성 후 Child 입력
      - Set Null : Master 테이블에 PK 없으면 Child 외부키 Null 값으로
      - Set Default : Master 테이블에 PK 없으면 Child 외부키 Default 값으로
      - Dependent : Master 테이블에 PK 존재하면 Child 입력 O
      - No Action : 참조무결성 X 삭제/수정 액션 X

  - 문제

    - 기관 분류

      분류 ID : VARCHAR(10) NOT NULL

      분류명 : VARCHAR(10) NOT NULL

      등록일자 : VARCHAR(10) NULL

    - 기관 분류

      분류 ID : VARCHAR(10) NOT NULL

      분류명 : VARCHAR(30) NOT NULL

      등록일자 : DATE NOT NULL

      ```sql
      ALTER TABLE 기관분류 ALTER COLUMN 분류명 VARCHAR(30) NOT NULL;
      ALTER TABLE 기관분류 ALTER COLUMN 등록일자 DATE NOT NULL;
      ```

  - 문제 : COMM Column 삭제

    | MGR  | ENAME | SAL  | COMM |
    | :--: | :---: | :--: | :--: |
    | 7566 | FORD  | 3000 |      |
    | 7698 | JAMES | 950  |      |

    ```sql
    ALTER TABLE EMP DROP COLUMN COMM;
    ```

- RENAME

  ```sql
  RENAME 변경전 테이블명 TO 변경후 테이블명;
  ```

  - 문제

    ```sql
    /* STADIUM 테이블 이름 -> STADIUM_JSC */
    RENAME STADIUM TO STADIUM_JSC;
    ```

    

- DROP

  ```sql
  DROP TABLE 테이블명 [CASCADE CONSTRAINT];
  ```

- TRUNCATE

  ```sql
  TRUNCATE TABLE PLAYER;
  ```

  



#### 제3절 DML

#### 제4절 TCL

#### 제5절 WHERE 절

#### 제6절 함수

#### 제7절 Group By, Having 절

#### 제8절 Order By 절

#### 제9절 조인 (JOIN)